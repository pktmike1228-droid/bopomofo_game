<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èªéŸ³è½è®€ç·´ç¿’ - Google TTS æ•´åˆç‰ˆ</title>
    <style>
        body {
            font-family: 'Arial', 'Microsoft JhengHei', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background-color: #f0f2f5;
            margin: 0;
            color: #333;
        }

        #game-container {
            background: #fff;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: 90%;
            max-width: 500px;
        }

        h1 { color: #2c3e50; font-size: 1.5rem; margin-bottom: 20px; }

        #mode-selector {
            margin-bottom: 20px;
            padding: 12px;
            font-size: 1em;
            border-radius: 10px;
            border: 2px solid #3498db;
            width: 100%;
            cursor: pointer;
            background-color: #fff;
        }
        
        #stats-container {
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #display-area {
            font-weight: bold;
            margin: 20px 0;
            color: #e74c3c;
            min-height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f8f9fa;
            border-radius: 15px;
            border: 2px solid #eee;
            transition: all 0.3s; 
        }

        #button-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .action-button {
            padding: 15px 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            border: none;
            border-radius: 12px;
            color: white;
            transition: all 0.2s;
        }

        #next-button { background-color: #3498db; flex: 1; }
        #next-button:hover { background-color: #2980b9; }
        
        #listen-button { background-color: #2ecc71; flex: 1; }
        #listen-button:hover { background-color: #27ae60; }
        #listen-button:disabled { background-color: #bdc3c7; }

        #reset-button { background-color: #95a5a6; padding: 8px 15px; font-size: 0.9em; }

        #message {
            margin-top: 15px;
            font-size: 0.9em;
            color: #95a5a6;
            min-height: 1.2em;
        }
    </style>
</head>
<body>

    <div id="game-container">
        <h1>ğŸ’¡ éš¨æ©Ÿè½è®€ç·´ç¿’</h1>

        <select id="mode-selector" onchange="resetGame()">
            <option value="zh">æ³¨éŸ³ç¬¦è™Ÿ (ã„…-ã„¦) [æœ¬åœ° MP3]</option>
            <option value="upper">è‹±æ–‡å­—æ¯ (å¤§å¯« A-Z) [Google TTS è‹±éŸ³]</option>
            <option value="lower">è‹±æ–‡å­—æ¯ (å°å¯« a-z) [Google TTS è‹±éŸ³]</option>
        </select>
        
        <div id="stats-container">
            <button id="reset-button" class="action-button" onclick="resetGame()">æ­¸é›¶ ğŸ”„</button>
            <div id="counter-display">ç·´ç¿’é¡Œæ•¸: 0</div>
        </div>

        <div id="display-area">æº–å‚™å¥½äº†å—ï¼Ÿ</div>

        <div id="button-group">
            <button id="next-button" class="action-button" onclick="startNewRound()">ä¸‹ä¸€é¡Œ</button>
            <button id="listen-button" class="action-button" onclick="playCurrentSound()" disabled>ğŸ‘‚ è½ç™¼éŸ³</button>
        </div>
        
        <div id="message">è«‹é»æ“Šä¸‹ä¸€é¡Œé–‹å§‹</div>

        <audio id="audio-player" preload="auto"></audio>
    </div>

    <script>
        const dataSets = {
            zh: ["ã„…", "ã„†", "ã„‡", "ã„ˆ", "ã„‰", "ã„Š", "ã„‹", "ã„Œ", "ã„", "ã„", "ã„", "ã„", "ã„‘", "ã„’", "ã„“", "ã„”", "ã„•", "ã„–", "ã„—", "ã„˜", "ã„™", "ã„§", "ã„¨", "ã„©", "ã„š", "ã„›", "ã„œ", "ã„", "ã„", "ã„Ÿ", "ã„ ", "ã„¡", "ã„¢", "ã„£", "ã„¤", "ã„¥", "ã„¦"],
            upper: ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"],
            lower: ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z"]
        };

        let currentSymbol = '';
        let roundCounter = 0; 

        const modeSelector = document.getElementById('mode-selector');
        const displayEl = document.getElementById('display-area');
        const messageEl = document.getElementById('message');
        const listenButton = document.getElementById('listen-button');
        const counterDisplay = document.getElementById('counter-display');
        const audioEl = document.getElementById('audio-player'); 

        /**
         * æ’­æ”¾æ ¸å¿ƒé‚è¼¯
         */
        function playCurrentSound() {
            if (!currentSymbol) return;
            
            const mode = modeSelector.value;
            let soundUrl = '';

            if (mode === 'zh') {
                // æ³¨éŸ³æ¨¡å¼ï¼šä½¿ç”¨æœ¬åœ° mp3/ è³‡æ–™å¤¾
                const index = dataSets.zh.indexOf(currentSymbol);
                const fileNumber = (index + 1).toString().padStart(2, '0');
                soundUrl = `mp3/${fileNumber}.mp3`;
            } else {
                // è‹±æ–‡æ¨¡å¼ï¼šä½¿ç”¨æ‚¨æä¾›çš„ Google TTS è‹±å¼ç™¼éŸ³é€£çµ
                // æˆ‘å€‘å°‡å­—æ¯ (currentSymbol) å‹•æ…‹æ”¾å…¥ q åƒæ•¸ä¸­
                soundUrl = `https://translate.google.com/translate_tts?ie=UTF-8&q=${encodeURIComponent(currentSymbol)}&tl=en-uk&client=tw-ob`;
            }

            // è¨­å®šæ’­æ”¾ä¾†æºä¸¦æ’­æ”¾
            audioEl.src = soundUrl;
            audioEl.pause();
            audioEl.currentTime = 0;
            
            listenButton.textContent = 'ğŸ”Š æ’­æ”¾ä¸­...';
            listenButton.disabled = true;

            audioEl.onended = () => {
                listenButton.textContent = 'ğŸ‘‚ è½ç™¼éŸ³';
                listenButton.disabled = false;
            };

            // éŒ¯èª¤è™•ç†ï¼šå¦‚æœ Google æ“‹æ‰è«‹æ±‚æˆ–æª”æ¡ˆä¸å­˜åœ¨
            audioEl.onerror = () => {
                console.error("ç„¡æ³•åŠ è¼‰éŸ³æª”:", soundUrl);
                messageEl.textContent = 'âŒ éŸ³æª”åŠ è¼‰å¤±æ•— (æª¢æŸ¥ç¶²çµ¡æˆ–è·¯å¾‘)';
                listenButton.textContent = 'ğŸ‘‚ è½ç™¼éŸ³';
                listenButton.disabled = false;
            };

            audioEl.play().catch(e => {
                console.error("æ’­æ”¾å˜—è©¦å¤±æ•—:", e);
                audioEl.onended();
            });
        }

        function startNewRound() {
            const mode = modeSelector.value;
            const currentList = dataSets[mode];
            
            roundCounter++; 
            counterDisplay.textContent = `ç·´ç¿’é¡Œæ•¸: ${roundCounter}`;

            currentSymbol = currentList[Math.floor(Math.random() * currentList.length)];
            displayEl.textContent = currentSymbol;
            
            // è¦–è¦ºèª¿æ•´
            displayEl.style.fontSize = (mode === 'zh') ? '10em' : '14em';
            displayEl.style.color = '#2c3e50'; 

            listenButton.disabled = false;
            messageEl.textContent = mode === 'zh' ? 'è«‹è½æ³¨éŸ³ (æœ¬åœ°éŸ³æª”)' : 'è«‹è½è‹±å¼ç™¼éŸ³ (Google API)';
        }
        
        function resetGame() {
            roundCounter = 0;
            counterDisplay.textContent = `ç·´ç¿’é¡Œæ•¸: 0`;
            currentSymbol = '';
            displayEl.textContent = 'Ready?';
            displayEl.style.fontSize = '4em'; 
            displayEl.style.color = '#bdc3c7'; 
            listenButton.disabled = true;
            messageEl.textContent = 'è«‹é»æ“Šä¸‹ä¸€é¡Œé–‹å§‹';
        }

        window.onload = resetGame;
    </script>
</body>
</html>
