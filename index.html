<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èªéŸ³è½è®€ç·´ç¿’ - é€Ÿåº¦å¯èª¿ç‰ˆ (å…¨ MP3)</title>
    <style>
        /* ... ä¿ç•™åŸæœ¬ CSS ... */
        body {
            font-family: 'Arial', 'Microsoft JhengHei', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background-color: #f4f4f9;
            margin: 0;
            color: #333;
        }

        #game-container {
            background: #fff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: 90%;
            max-width: 500px;
        }

        h1 { color: #2c3e50; margin-bottom: 15px; font-size: 1.5rem; }

        #mode-selector {
            margin-bottom: 15px;
            padding: 10px;
            font-size: 1.1em;
            border-radius: 5px;
            border: 2px solid #3498db;
            width: 100%;
        }

        /* æ–°å¢ï¼šé€Ÿåº¦æ§åˆ¶å€å¡Šæ¨£å¼ */
        #speed-control-box {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            border: 1px solid #eee;
        }

        #speed-slider { width: 150px; cursor: pointer; }
        .speed-label { font-weight: bold; color: #3498db; min-width: 45px; }
        
        #stats-container {
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 10px;
        }

        #display-area {
            font-weight: bold;
            margin: 20px 0;
            color: #e74c3c;
            min-height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f0f7ff;
            border-radius: 10px;
            border: 2px dashed #ddd;
            transition: all 0.3s;
        }

        #button-group { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; }

        .action-button {
            padding: 12px 20px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            color: white;
            transition: all 0.2s;
        }

        #next-button { background-color: #3498db; flex: 1; }
        #listen-button { background-color: #2ecc71; flex: 1; }
        #listen-button:disabled { background-color: #bdc3c7; }
        #reset-button { background-color: #f39c12; font-size: 0.9em; }

        #message { margin-top: 15px; font-size: 1em; color: #7f8c8d; }
    </style>
</head>
<body>

    <div id="game-container">
        <h1>âœ¨ éš¨æ©Ÿè½è®€ç·´ç¿’</h1>

        <select id="mode-selector" onchange="resetGame()">
            <option value="zh">æ³¨éŸ³ç¬¦è™Ÿ (ã„…-ã„¦)</option>
            <option value="upper">è‹±æ–‡å­—æ¯ (å¤§å¯« A-Z)</option>
            <option value="lower">è‹±æ–‡å­—æ¯ (å°å¯« a-z)</option>
        </select>

        <div id="speed-control-box">
            <span>ğŸ¢ æ…¢</span>
            <input type="range" id="speed-slider" min="0.5" max="1.0" step="0.1" value="1.0">
            <span>å¿« ğŸ‡</span>
            <span class="speed-label" id="speed-display">1.0x</span>
        </div>
        
        <div id="stats-container">
            <button id="reset-button" class="action-button" onclick="resetGame()">é‡æ–°é–‹å§‹ ğŸ”„</button>
            <div id="counter-display">å·²ç·´ç¿’é¡Œæ•¸: 0</div>
        </div>

        <div id="display-area">è«‹é»æ“Šä¸‹ä¸€é¡Œé–‹å§‹</div>

        <div id="button-group">
            <button id="next-button" class="action-button" onclick="startNewRound()">ä¸‹ä¸€é¡Œ</button>
            <button id="listen-button" class="action-button" onclick="playCurrentSound()" disabled>ğŸ‘‚ è½ç™¼éŸ³</button>
        </div>
        
        <div id="message">æº–å‚™å¥½äº†å—ï¼Ÿ</div>

        <audio id="audio-player" preload="auto"></audio>
    </div>

    <script>
        const dataSets = {
            zh: ["ã„…", "ã„†", "ã„‡", "ã„ˆ", "ã„‰", "ã„Š", "ã„‹", "ã„Œ", "ã„", "ã„", "ã„", "ã„", "ã„‘", "ã„’", "ã„“", "ã„”", "ã„•", "ã„–", "ã„—", "ã„˜", "ã„™", "ã„§", "ã„¨", "ã„©", "ã„š", "ã„›", "ã„œ", "ã„", "ã„", "ã„Ÿ", "ã„ ", "ã„¡", "ã„¢", "ã„£", "ã„¤", "ã„¥", "ã„¦"],
            upper: ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"],
            lower: ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z"]
        };

        let currentSymbol = '';
        let roundCounter = 0; 

        const modeSelector = document.getElementById('mode-selector');
        const speedSlider = document.getElementById('speed-slider');
        const speedDisplay = document.getElementById('speed-display');
        const displayEl = document.getElementById('display-area');
        const messageEl = document.getElementById('message');
        const listenButton = document.getElementById('listen-button');
        const counterDisplay = document.getElementById('counter-display');
        const audioEl = document.getElementById('audio-player'); 

        // ç›£è½é€Ÿåº¦æ»‘æ¡¿ï¼Œå³æ™‚æ›´æ–°æ•¸å€¼é¡¯ç¤º
        speedSlider.addEventListener('input', () => {
            speedDisplay.textContent = speedSlider.value + 'x';
            // å¦‚æœéŸ³è¨Šæ­£åœ¨æ’­æ”¾ï¼Œå³æ™‚èª¿æ•´é€Ÿåº¦
            audioEl.playbackRate = speedSlider.value;
        });

        function getMp3FilePath(symbol) {
            const mode = modeSelector.value;
            const index = dataSets[mode].indexOf(symbol);
            if (index === -1) return '';
            const fileNumber = (index + 1).toString().padStart(2, '0');
            return `mp3/${mode}/${fileNumber}.mp3`;
        }

        function playCurrentSound() {
            if (!currentSymbol) return;
            
            const mp3Path = getMp3FilePath(currentSymbol);
            audioEl.src = mp3Path;
            
            // é‡è¦ï¼šåœ¨è¨­å®š src ä¹‹å¾Œé‡æ–°å¥—ç”¨é€Ÿåº¦ï¼Œå› ç‚ºåˆ‡æ›ä¾†æºæœ‰æ™‚æœƒé‡ç½®é€Ÿåº¦
            audioEl.playbackRate = speedSlider.value;
            
            audioEl.pause();
            audioEl.currentTime = 0;
            
            listenButton.textContent = 'ğŸ”Š æ’­æ”¾ä¸­...';
            listenButton.disabled = true;

            audioEl.onended = function() {
                listenButton.textContent = 'ğŸ‘‚ è½ç™¼éŸ³';
                listenButton.disabled = false;
            };

            audioEl.onerror = function() {
                messageEl.textContent = 'âŒ æ‰¾ä¸åˆ°éŸ³æª”ï¼š' + mp3Path;
                listenButton.textContent = 'ğŸ‘‚ è½ç™¼éŸ³';
                listenButton.disabled = false;
            };

            audioEl.play().catch(e => {
                messageEl.textContent = 'æ’­æ”¾å¤±æ•—ï¼Œè«‹æª¢æŸ¥æª”æ¡ˆã€‚';
                audioEl.onended();
            });
        }

        function startNewRound() {
            const mode = modeSelector.value;
            roundCounter++; 
            counterDisplay.textContent = `å·²ç·´ç¿’é¡Œæ•¸: ${roundCounter}`;
            currentSymbol = dataSets[mode][Math.floor(Math.random() * dataSets[mode].length)];
            displayEl.textContent = currentSymbol;
            displayEl.style.fontSize = (mode === 'zh') ? '12em' : '15em';
            displayEl.style.color = '#e74c3c'; 
            listenButton.disabled = false;
            messageEl.textContent = `è«‹é»æ“Šè½è½çœ‹ã€‚`;
        }
        
        function resetGame() {
            roundCounter = 0;
            counterDisplay.textContent = `å·²ç·´ç¿’é¡Œæ•¸: 0`;
            currentSymbol = '';
            displayEl.textContent = 'Ready?';
            displayEl.style.fontSize = '4em'; 
            displayEl.style.color = '#bdc3c7'; 
            listenButton.disabled = true;
            messageEl.textContent = `å·²åˆ‡æ›æ¨¡å¼ã€‚`;
            audioEl.removeAttribute('src'); 
        }

        window.onload = resetGame;
    </script>
</body>
</html>